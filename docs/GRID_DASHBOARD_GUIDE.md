# 网格后台管理系统使用说明

## 系统概述

网格后台管理系统为您提供了一个直观的Web界面，用于管理和监控所有网格交易配置。

## 功能特性

### 1. 网格列表页面

**访问地址**: `http://localhost:8000/grid-trading/grids/`

**功能**:
- 查看所有网格配置的概览
- 显示关键指标：交易对、模式、层数、价格区间
- 实时显示：持仓层级、成交次数、运行状态
- 点击"查看详情"进入单个网格的详细页面

**显示的数据**:
```
┌─────────────────────────────────────────────────────────────────┐
│ 网格名称 │ 交易对 │ 模式 │ 层数 │ 价格区间 │ 持仓层级 │ 成交次数 │
├─────────────────────────────────────────────────────────────────┤
│ MONUSDT  │ MONUSDT│ SHORT│ 100  │ 0.01-0.05│   4/100  │    68   │
└─────────────────────────────────────────────────────────────────┘
```

### 2. 网格详情页面

**访问地址**: `http://localhost:8000/grid-trading/grids/{config_id}/`

**功能**:
- 查看完整的网格配置参数
- 实时统计数据（层级状态、成交统计）
- 两个Tab切换：
  - **活跃层级**: 显示有订单的层级详情
  - **运行历史**: 显示最近20条事件记录

**配置信息展示**:
- 交易对、网格模式、层数
- 价格区间、网格间距、间距百分比
- 每格交易数量、最大持仓限制
- 创建时间、运行状态

**统计数据**:
- 总事件数
- 成交次数（开仓/平仓分类）
- 持仓层级（含挂单中数量）
- 空闲层级（含挂单中数量）

**活跃层级表格**:
```
┌───────────────────────────────────────────────────┐
│ 层级 │ 价格     │ 方向 │ 状态         │ 订单信息 │
├───────────────────────────────────────────────────┤
│  1   │ 0.030202 │ SELL │ position_open│ order_123│
│  2   │ 0.030606 │ SELL │ exit_working │ order_124│
└───────────────────────────────────────────────────┘
```

**运行历史时间线**:
- 按时间倒序显示事件
- 事件类型标签（info/warn/error/order/fill）
- 事件详情、关联订单ID、层级索引
- 发生时间

## API接口

### 网格列表API

**端点**: `GET /grid-trading/api/grids/`

**响应示例**:
```json
{
  "grids": [
    {
      "id": 1,
      "name": "MONUSDT_backtest_demo",
      "symbol": "MONUSDT",
      "grid_mode": "SHORT",
      "grid_levels": 100,
      "price_range": "0.01-0.05",
      "is_active": false,
      "stats": {
        "total_events": 188,
        "total_fills": 68,
        "position_levels": 4
      },
      "created_at": "2025-12-05 08:54:23"
    }
  ]
}
```

### 网格详情API

**端点**: `GET /grid-trading/api/grids/{config_id}/`

**响应示例**:
```json
{
  "config": {
    "id": 1,
    "name": "MONUSDT_backtest_demo",
    "symbol": "MONUSDT",
    "grid_mode": "SHORT",
    "grid_levels": 100,
    "upper_price": 0.05,
    "lower_price": 0.01,
    "grid_spacing": 0.000404,
    "grid_spacing_pct": 1.34,
    "trade_amount": 100.0,
    "max_position_size": 5000.0,
    "is_active": false,
    "created_at": "2025-12-05 08:54:23"
  },
  "stats": {
    "total_levels": 100,
    "idle": 50,
    "entry_working": 0,
    "position_open": 0,
    "exit_working": 0,
    "total_events": 188,
    "total_fills": 68,
    "entry_fills": 36,
    "exit_fills": 32
  },
  "levels": [...],
  "recent_events": [...]
}
```

## 使用场景

### 场景1: 监控运行中的网格

1. 访问网格列表页面
2. 查看"持仓层级"列，了解当前有多少层级持有仓位
3. 点击"查看详情"进入详情页
4. 切换到"活跃层级"Tab查看具体哪些层级有订单
5. 切换到"运行历史"Tab查看最近的成交和挂单记录

### 场景2: 分析回测结果

1. 运行回测命令：`python manage.py backtest_grid --config-id 1 --csv data.csv --equity 10000`
2. 访问网格详情页面：`http://localhost:8000/grid-trading/grids/1/`
3. 查看统计数据卡片：
   - 总事件数：了解系统运行活跃度
   - 成交次数：查看开仓/平仓分布
   - 持仓层级：最终持仓情况
4. 切换到"运行历史"查看详细交易流程

### 场景3: 对比多个网格配置

1. 访问网格列表页面
2. 对比不同配置的：
   - 成交次数（交易频率）
   - 持仓层级（资金使用率）
   - 运行状态
3. 点击各个配置查看详细数据

## 技术栈

- **后端**: Django + Python
- **前端**: HTML5 + Tailwind CSS + Alpine.js
- **数据展示**: 表格、卡片、时间线
- **交互**: AJAX异步加载，无需刷新页面

## 浏览器兼容性

- Chrome/Edge: ✅ 完全支持
- Firefox: ✅ 完全支持
- Safari: ✅ 完全支持

## 快速开始

1. 启动Django开发服务器：
   ```bash
   python manage.py runserver
   ```

2. 访问网格列表页面：
   ```
   http://localhost:8000/grid-trading/grids/
   ```

3. 点击任意网格的"查看详情"按钮，进入详情页面

## 注意事项

1. **数据实时性**: 页面加载时从数据库读取数据，点击刷新按钮可重新加载最新数据
2. **活跃层级**: 仅显示有订单的层级（最多50条），空闲层级不显示以提高性能
3. **运行历史**: 仅显示最近20条事件，需要查看完整历史请使用TradeLog API
4. **状态颜色**:
   - 绿色：成功、持仓、买入
   - 红色：错误、卖出
   - 黄色：警告、挂单中
   - 蓝色：信息、平仓
   - 紫色：订单操作

## 扩展功能建议

如需增强功能，可以考虑：
1. 添加筛选和搜索功能
2. 添加图表展示（价格走势、盈亏曲线）
3. 添加批量操作（批量启动/停止）
4. 添加实时WebSocket推送（无需刷新自动更新）
5. 导出功能（导出CSV/Excel报告）
