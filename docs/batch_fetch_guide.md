# æ‰¹é‡è·å–äº¤æ˜“æ‰€å…¬å‘Šä½¿ç”¨æŒ‡å—

æœ¬é¡¹ç›®æä¾›äº†æ‰¹é‡è·å–å¤šä¸ªäº¤æ˜“æ‰€å…¬å‘Šçš„åŠŸèƒ½ï¼Œæ”¯æŒBinanceã€Bybitã€Bitgetä¸‰ä¸ªäº¤æ˜“æ‰€ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼1ï¼šä½¿ç”¨Shellè„šæœ¬ï¼ˆæ¨èï¼‰

æœ€ç®€å•çš„æ–¹å¼ï¼Œä¸€è¡Œå‘½ä»¤æå®šï¼š

```bash
# è·å–æœ€è¿‘24å°æ—¶çš„å…¬å‘Šï¼ˆé»˜è®¤ï¼‰
./scripts/fetch_announcements.sh

# è·å–æœ€è¿‘1å°æ—¶çš„å…¬å‘Š
./scripts/fetch_announcements.sh 1

# è·å–æœ€è¿‘48å°æ—¶çš„å…¬å‘Š
./scripts/fetch_announcements.sh 48
```

### æ–¹å¼2ï¼šä½¿ç”¨Django Management Command

æ›´çµæ´»çš„é…ç½®æ–¹å¼ï¼š

```bash
# åŸºæœ¬ç”¨æ³•ï¼ˆè·å–å…¨éƒ¨å…¬å‘Šï¼‰
python manage.py fetch_all_announcements

# åªè·å–æœ€è¿‘24å°æ—¶çš„å…¬å‘Š
python manage.py fetch_all_announcements --hours 24

# è‡ªå®šä¹‰é¡µæ•°å’Œæ—¶é—´èŒƒå›´
python manage.py fetch_all_announcements --hours 24 --max-pages 5

# åªè·å–ç‰¹å®šäº¤æ˜“æ‰€
python manage.py fetch_all_announcements --exchanges "binance,bybit"
```

## ğŸ“‹ å‚æ•°è¯´æ˜

### Shellè„šæœ¬å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ | ç¤ºä¾‹ |
|------|------|--------|------|
| `[hours]` | è·å–æœ€è¿‘Nå°æ—¶çš„å…¬å‘Š | 24 | `./scripts/fetch_announcements.sh 1` |

### Djangoå‘½ä»¤å‚æ•°

| å‚æ•° | å¿…å¡« | è¯´æ˜ | é»˜è®¤å€¼ | ç¤ºä¾‹ |
|------|------|------|--------|------|
| `--hours` | âŒ | åªè·å–æœ€è¿‘Nå°æ—¶çš„å…¬å‘Š | Noneï¼ˆå…¨éƒ¨ï¼‰ | `--hours 24` |
| `--max-pages` | âŒ | æ¯ä¸ªäº¤æ˜“æ‰€æœ€å¤§çˆ¬å–é¡µæ•° | 2 | `--max-pages 5` |
| `--exchanges` | âŒ | æŒ‡å®šäº¤æ˜“æ‰€ï¼ˆé€—å·åˆ†éš”ï¼‰ | binance,bybit,bitget | `--exchanges "binance,bybit"` |

## ğŸ“Š ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå®šæ—¶ç›‘æ§ï¼ˆæ¯å°æ—¶ï¼‰

ä½¿ç”¨crontabè®¾ç½®å®šæ—¶ä»»åŠ¡ï¼š

```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œè·å–æœ€è¿‘2å°æ—¶çš„å…¬å‘Šï¼‰
0 * * * * cd /path/to/crypto_exchange_news_crawler && ./scripts/fetch_announcements.sh 2 >> logs/fetch.log 2>&1
```

### åœºæ™¯2ï¼šé«˜é¢‘ç›‘æ§ï¼ˆæ¯15åˆ†é’Ÿï¼‰

```bash
# æ¯15åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œè·å–æœ€è¿‘30åˆ†é’Ÿçš„å…¬å‘Š
*/15 * * * * cd /path/to/crypto_exchange_news_crawler && ./scripts/fetch_announcements.sh 0.5 >> logs/fetch.log 2>&1
```

### åœºæ™¯3ï¼šæ‰‹åŠ¨æµ‹è¯•

```bash
# å¿«é€Ÿæµ‹è¯•ï¼ˆåªè·å–æœ€è¿‘1å°æ—¶çš„å…¬å‘Šï¼‰
./scripts/fetch_announcements.sh 1

# æˆ–ä½¿ç”¨Djangoå‘½ä»¤
python manage.py fetch_all_announcements --hours 1 --max-pages 1
```

## ğŸ” è¾“å‡ºç¤ºä¾‹

è¿è¡Œè„šæœ¬åï¼Œæ‚¨ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š

```
==========================================
åŠ å¯†è´§å¸äº¤æ˜“æ‰€å…¬å‘Šç›‘æ§ç³»ç»Ÿ
==========================================
é¡¹ç›®ç›®å½•: /Users/xxx/crypto_exchange_news_crawler
æ—¶é—´èŒƒå›´: æœ€è¿‘ 24 å°æ—¶
äº¤æ˜“æ‰€: Binance, Bybit, Bitget
==========================================

å¼€å§‹æ‰¹é‡è·å–å…¬å‘Š (æœ€è¿‘24å°æ—¶, æœ€å¤§é¡µæ•°: 3)
é…ç½®çš„äº¤æ˜“æ‰€: binance, bybit, bitget

============================================================
æ­£åœ¨è·å–: Binance (binance)
============================================================
âœ“ Binance: æˆåŠŸè·å– 5 æ¡å…¬å‘Š

============================================================
æ­£åœ¨è·å–: Bybit (bybit)
============================================================
âœ“ Bybit: æˆåŠŸè·å– 1 æ¡å…¬å‘Š

============================================================
æ­£åœ¨è·å–: Bitget (bitget)
============================================================
âœ“ Bitget: æˆåŠŸè·å– 16 æ¡å…¬å‘Š

============================================================
æ±‡æ€»ç»“æœ
============================================================
âœ“ æˆåŠŸ: 3/3 ä¸ªäº¤æ˜“æ‰€
âœ“ æ€»è®¡è·å–: 22 æ¡å…¬å‘Š

æ•°æ®åº“ç»Ÿè®¡:
  - Binance: 400 æ¡å…¬å‘Š
  - Bitget: 281 æ¡å…¬å‘Š
  - Bybit: 8 æ¡å…¬å‘Š

==========================================
âœ“ å…¬å‘Šè·å–å®Œæˆ
==========================================
```

## âš™ï¸ é…ç½®äº¤æ˜“æ‰€

å¦‚æœéœ€è¦ä¿®æ”¹è¦è·å–çš„äº¤æ˜“æ‰€åˆ—è¡¨ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š

### æ–¹å¼1ï¼šä¿®æ”¹Shellè„šæœ¬ï¼ˆæ°¸ä¹…ï¼‰

ç¼–è¾‘ `scripts/fetch_announcements.sh`ï¼š

```bash
# åªè·å–Binanceå’ŒBybit
--exchanges "binance,bybit"

# æˆ–æ·»åŠ æ›´å¤šäº¤æ˜“æ‰€
--exchanges "binance,bybit,bitget,okx"
```

### æ–¹å¼2ï¼šå‘½ä»¤è¡Œå‚æ•°ï¼ˆä¸´æ—¶ï¼‰

```bash
python manage.py fetch_all_announcements --exchanges "binance,bybit"
```

## ğŸ“ æ—¥å¿—ç®¡ç†

å»ºè®®åˆ›å»ºæ—¥å¿—ç›®å½•æ¥ä¿å­˜æ‰§è¡Œè®°å½•ï¼š

```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p logs

# è¿è¡Œå¹¶ä¿å­˜æ—¥å¿—
./scripts/fetch_announcements.sh 24 >> logs/fetch_$(date +%Y%m%d).log 2>&1

# æŸ¥çœ‹ä»Šå¤©çš„æ—¥å¿—
tail -f logs/fetch_$(date +%Y%m%d).log
```

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šè„šæœ¬æ— æ‰§è¡Œæƒé™

```bash
chmod +x scripts/fetch_announcements.sh
```

### é—®é¢˜2ï¼šæŸä¸ªäº¤æ˜“æ‰€è·å–å¤±è´¥

æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œå¯èƒ½åŸå› ï¼š
- ç½‘ç»œè¿æ¥é—®é¢˜
- äº¤æ˜“æ‰€ç½‘ç«™ç»“æ„å˜æ›´
- Scrapyçˆ¬è™«é…ç½®é—®é¢˜

å¯ä»¥å•ç‹¬æµ‹è¯•è¯¥äº¤æ˜“æ‰€ï¼š
```bash
python manage.py fetch_announcements --exchange binance --max-pages 1
```

### é—®é¢˜3ï¼šæ²¡æœ‰è·å–åˆ°å…¬å‘Š

å¯èƒ½åŸå› ï¼š
- æ—¶é—´èŒƒå›´å¤ªå°ï¼ˆå¦‚--hours 1æ—¶æœ€è¿‘1å°æ—¶æ²¡æœ‰æ–°å…¬å‘Šï¼‰
- è¯¥äº¤æ˜“æ‰€åœ¨æ•°æ®åº“ä¸­æœªå¯ç”¨

è§£å†³æ–¹æ³•ï¼š
```bash
# æ£€æŸ¥äº¤æ˜“æ‰€çŠ¶æ€
python manage.py shell
>>> from monitor.models import Exchange
>>> Exchange.objects.all().values('name', 'code', 'enabled')

# æˆ–é‡æ–°åˆå§‹åŒ–
python manage.py init_exchanges
```

## ğŸ“š æ›´å¤šå‘½ä»¤

```bash
# æŸ¥çœ‹å¸®åŠ©
python manage.py fetch_all_announcements --help

# åˆå§‹åŒ–äº¤æ˜“æ‰€æ•°æ®
python manage.py init_exchanges

# æŸ¥çœ‹å•ä¸ªäº¤æ˜“æ‰€è¯¦æƒ…
python manage.py fetch_announcements --exchange binance --help
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **ç”Ÿäº§ç¯å¢ƒ**ï¼šä½¿ç”¨crontabå®šæ—¶ä»»åŠ¡ï¼Œé…ç½® `--hours` å‚æ•°ä¸ºå®šæ—¶é—´éš”çš„2å€ï¼ˆç•™æœ‰å†—ä½™ï¼‰
2. **æµ‹è¯•ç¯å¢ƒ**ï¼šæ‰‹åŠ¨è¿è¡Œï¼Œä½¿ç”¨è¾ƒå°çš„ `--max-pages` å’Œ `--hours` å‚æ•°
3. **æ—¥å¿—ç®¡ç†**ï¼šå®šæœŸæ¸…ç†æ—§æ—¥å¿—ï¼Œå»ºè®®ä¿ç•™æœ€è¿‘7å¤©
4. **ç›‘æ§å‘Šè­¦**ï¼šå¯ä»¥ç»“åˆè„šæœ¬è¿”å›å€¼è®¾ç½®å‘Šè­¦

```bash
# ç¤ºä¾‹ï¼šè·å–å¤±è´¥æ—¶å‘é€é‚®ä»¶
./scripts/fetch_announcements.sh 24 || echo "è·å–å¤±è´¥" | mail -s "å…¬å‘Šç›‘æ§å‘Šè­¦" admin@example.com
```
