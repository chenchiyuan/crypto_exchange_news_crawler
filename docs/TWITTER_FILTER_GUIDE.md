# Twitter 推文时间过滤器 - 使用指南

## 🎯 功能概述

推文时间过滤器允许您按时间窗口快速获取推文，**无需AI分析**，仅按时间范围过滤和输出推文内容。

## 🚀 快速开始

### 基础用法

```bash
# 获取最近24小时的推文
python manage.py run_analysis 1939614372311302186 --filter-only

# 获取最近12小时的推文
python manage.py run_analysis 1939614372311302186 --filter-only --hours 12

# 获取最近48小时的推文（2天）
python manage.py run_analysis 1939614372311302186 --filter-only --hours 48
```

## 📋 参数说明

### 核心参数

| 参数 | 类型 | 说明 | 示例 |
|------|------|------|------|
| `--filter-only` | 开关 | 启用时间过滤模式（跳过AI分析） | `--filter-only` |
| `--hours` | 整数 | 时间窗口（小时，默认24） | `--hours 48` |
| `--dry-run` | 开关 | 试运行（不保存到数据库） | `--dry-run` |
| `--no-cache` | 开关 | 禁用缓存（获取最新推文） | `--no-cache` |

## 📊 使用场景示例

### 场景1：日常监控
```bash
# 监控最近24小时的内容
python manage.py run_analysis 1939614372311302186 --filter-only --hours 24
```

### 场景2：短期分析
```bash
# 分析最近12小时的内容
python manage.py run_analysis 1939614372311302186 --filter-only --hours 12
```

### 场景3：周度回顾
```bash
# 查看最近一周的内容
python manage.py run_analysis 1939614372311302186 --filter-only --hours 168
```

### 场景4：实时监控
```bash
# 查看最近6小时的内容（适合实时监控）
python manage.py run_analysis 1939614372311302186 --filter-only --hours 6
```

### 场景5：获取最新数据
```bash
# 禁用缓存，获取最新推文
python manage.py run_analysis 1939614372311302186 --filter-only --hours 24 --no-cache
```

## 💾 输出结果

过滤完成后，系统会：
1. 在控制台显示时间窗口和推文统计
2. 将结果保存到文件：`time_filtered_tweets_{list_id}_{timestamp}.txt`

### 文件格式
```
按时间过滤结果 - List 1939614372311302186
时间范围: 2025-11-17 02:58:08+00:00 ~ 2025-11-18 02:58:08+00:00
推文总数: 20 条
================================================================================

1. [@username] (2025-11-17 10:12)
   内容: 推文内容...
   互动: 👍116 🔄8 💬28
   Tweet ID: 1990362329549303907
```

## 🔍 时间窗口说明

### 时间范围
- **默认**：24小时
- **最小**：1小时
- **最大**：168小时（1周）
- **基于推文发布时间**：`tweet_created_at`

### 时间逻辑
- **向后计算**：从当前时间往前推 N 小时
- **包含边界**：包含起始时间点之后的推文
- **排序方式**：按时间倒序（最新的在前）

## 📈 性能优化

### 最佳实践
1. **使用缓存**：默认启用，避免重复获取相同时间段的推文
2. **合理时间窗口**：
   - 实时监控：6-12小时
   - 日常分析：24-48小时
   - 周度回顾：72-168小时
3. **按需禁用缓存**：需要最新数据时使用 `--no-cache`

### 限制说明
- **最大输出**：500条推文（超过则截取最新的500条）
- **查询范围**：最多500条推文进行过滤
- **试运行**：建议先用 `--dry-run` 测试

## ❓ 常见问题

### Q: 如何设置特定时间段？
A: 时间过滤只能按"过去N小时"的方式设置，无法指定具体的开始和结束时间。

### Q: 为什么有些推文没有包含在结果中？
A: 可能原因：
- 推文发布时间超出指定的时间窗口
- 推文被限制在最多500条输出

### Q: 如何查看历史结果？
A: 结果会保存到 `time_filtered_tweets_*.txt` 文件中，直接打开即可查看。

### Q: 时间窗口计算方式？
A: 从当前系统时间往前推指定的小时数。例如：当前是10:00，设置12小时，则获取22:00到10:00的推文。

### Q: 可以同时使用多个过滤条件吗？
A: 当前版本只支持时间过滤。如需内容筛选，建议后续版本会添加或使用其他工具。

## 🎉 总结

推文时间过滤器是一个轻量级工具，让您能够：
- ✅ 快速按时间窗口获取推文
- ✅ 无需AI分析，即时获得结果
- ✅ 简单高效，适合大规模数据预处理
- ✅ 标准化的输出格式，便于后续分析

开始使用时间过滤器，让数据分析更高效！ 🚀
