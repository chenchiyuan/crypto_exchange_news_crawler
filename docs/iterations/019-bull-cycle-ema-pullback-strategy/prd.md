# PRD: 策略5 - 强势上涨周期EMA25回调策略

**迭代编号**: 019
**创建时间**: 2026-01-07
**状态**: 需求定义中

---

## 1. 背景与目标

### 1.1 背景

基于迭代018实现的β宏观周期指标，我们可以识别市场处于强势上涨阶段（bull_strong）。在强势上涨阶段，价格回调至EMA25是一个常见的买入机会，因为趋势仍然向上，回调只是暂时的休整。

### 1.2 目标

实现策略5：在强势上涨周期中，当价格回调触及EMA25时买入，并设置P95止盈和5%止损。

---

## 2. 用户故事

**作为** 量化交易者
**我希望** 在强势上涨阶段捕捉EMA25回调买入机会
**以便于** 在趋势明确时以较好的价格入场，并通过止盈止损管理风险

---

## 3. 功能需求

### 3.1 策略定义

| 策略ID | 名称 | 方向 | 描述 |
|--------|------|------|------|
| 5 | 强势上涨EMA回调 | 做多 | 强势上涨周期中EMA25回调买入 |

### 3.2 入场条件

| 条件编号 | 条件 | 说明 |
|----------|------|------|
| 1 | cycle_phase == 'bull_strong' | 当前K线处于强势上涨阶段 |
| 2 | low <= ema25 <= high | K线价格区间包含EMA25（回调触及EMA25） |

**买入逻辑**: 当条件1和条件2同时满足时，以当前K线的close价格买入。

### 3.3 出场条件

| 出场类型 | 条件 | 说明 |
|----------|------|------|
| 止盈 | price >= P95 | 价格达到P95静态阈值时卖出 |
| 止损 | price <= buy_price * 0.95 | 价格下跌5%时止损卖出 |

**出场优先级**: 止损 > 止盈（同时满足时优先止损）

### 3.4 仓位管理

- **单笔仓位**: 100 USDT（可配置）
- **最大持仓**: 10笔（可配置）

### 3.5 配置参数

```json
{
  "id": "strategy_5",
  "name": "强势上涨EMA回调",
  "type": "bull-cycle-ema-pullback",
  "enabled": true,
  "entry": {
    "cycle_phase": "bull_strong",
    "ema_period": 25
  },
  "exits": [
    {
      "type": "p95_take_profit",
      "params": {}
    },
    {
      "type": "stop_loss",
      "params": {"percentage": 5}
    }
  ]
}
```

---

## 4. 技术约束

### 4.1 依赖

- **迭代018**: β宏观周期指标（cycle_phase）
- **DDPS-Z指标**: EMA25, P95

### 4.2 指标需求

| 指标 | 用途 | 来源 |
|------|------|------|
| ema25 | 入场判断（EMA25回调） | DDPS计算器 |
| cycle_phase | 入场判断（强势上涨） | BetaCycleCalculator |
| p95 | 止盈价格 | DDPS计算器 |

### 4.3 实现方式

**方案**: 新建独立策略类 `BullCycleEMAPullbackStrategy`

理由:
1. 策略逻辑与现有DDPS-Z策略（策略1-4）差异较大
2. 需要新的指标（cycle_phase）
3. 出场逻辑不同（P95止盈 vs EMA25回归）

---

## 5. 验收标准

- [ ] 策略5正确识别强势上涨周期的EMA25回调买入点
- [ ] P95止盈正确触发
- [ ] 5%止损正确触发
- [ ] 配置文件可正确加载
- [ ] 回测结果可查看

---

## 6. 回测要求

| 参数 | 值 |
|------|-----|
| 交易对 | ETHUSDT |
| 时间范围 | 2025-01-01 至今 |
| K线周期 | 4h |
| 初始资金 | 10000 USDT |

---

**创建人**: PowerBy Product
**最后更新**: 2026-01-07
