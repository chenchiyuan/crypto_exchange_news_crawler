# 迭代037：策略16详情页 - 验收清单

## 概述

- **迭代编号**: 037
- **迭代名称**: 策略16详情页
- **验收日期**: _待填写_
- **验收人员**: _待填写_

---

## 功能验收

### 1. 策略16数据集成

| 序号 | 验收项 | 验收标准 | 状态 |
|------|--------|---------|------|
| 1.1 | Strategy16Runner创建 | 服务类能正确调用Strategy16LimitEntry | ⬜ |
| 1.2 | 回测数据返回 | 返回orders/holdings/pending_order/statistics | ⬜ |
| 1.3 | 持仓浮动盈亏 | holdings包含floating_pnl和floating_pnl_rate | ⬜ |
| 1.4 | 持仓排序 | 持仓按buy_timestamp倒序排列 | ⬜ |
| 1.5 | 异常处理 | 回测失败时返回空数据而非抛出异常 | ⬜ |

### 2. API接口

| 序号 | 验收项 | 验收标准 | 状态 |
|------|--------|---------|------|
| 2.1 | strategy_mode参数 | API支持?strategy_mode=strategy16参数 | ⬜ |
| 2.2 | 默认模式 | 不传参数时默认使用strategy16模式 | ⬜ |
| 2.3 | legacy模式 | ?strategy_mode=legacy返回旧策略1/2数据 | ⬜ |
| 2.4 | 响应结构 | 响应包含chart.strategy16字段 | ⬜ |

### 3. 前端页面

| 序号 | 验收项 | 验收标准 | 状态 |
|------|--------|---------|------|
| 3.1 | 筛选按钮移除 | 策略1/策略2筛选按钮已删除 | ⬜ |
| 3.2 | 统计面板更新 | 显示策略16的统计数据 | ⬜ |
| 3.3 | 持仓数指标 | 统计面板包含"持仓数"指标 | ⬜ |
| 3.4 | K线买卖标记 | 正确显示策略16的买卖标记 | ⬜ |

### 4. 持仓列表

| 序号 | 验收项 | 验收标准 | 状态 |
|------|--------|---------|------|
| 4.1 | 列表展示 | 持仓列表卡片正确显示 | ⬜ |
| 4.2 | 字段完整 | 包含订单ID/买入价/当前价/浮盈亏/持仓时长 | ⬜ |
| 4.3 | 排序正确 | 最新持仓排在最前面 | ⬜ |
| 4.4 | 盈亏颜色 | 盈利绿色，亏损红色 | ⬜ |
| 4.5 | 空状态 | 无持仓时显示"暂无持仓" | ⬜ |
| 4.6 | 数量徽章 | 卡片标题显示持仓数量徽章 | ⬜ |

### 5. 挂单列表

| 序号 | 验收项 | 验收标准 | 状态 |
|------|--------|---------|------|
| 5.1 | 列表展示 | 挂单列表卡片正确显示 | ⬜ |
| 5.2 | 字段完整 | 包含挂单ID/价格/金额/数量/状态/创建时间 | ⬜ |
| 5.3 | 空状态 | 无挂单时显示"暂无挂单" | ⬜ |
| 5.4 | 数量徽章 | 卡片标题显示挂单数量徽章 | ⬜ |

---

## 兼容性验收

| 序号 | 验收项 | 验收标准 | 状态 |
|------|--------|---------|------|
| C.1 | legacy模式可用 | strategy_mode=legacy时旧功能正常 | ⬜ |
| C.2 | 其他页面不受影响 | DDPS首页、列表页功能正常 | ⬜ |
| C.3 | 多symbol支持 | BTCUSDT/ETHUSDT等不同交易对都能正常显示 | ⬜ |

---

## 性能验收

| 序号 | 验收项 | 验收标准 | 状态 |
|------|--------|---------|------|
| P.1 | 页面加载时间 | 首次加载 < 3秒 | ⬜ |
| P.2 | 回测耗时 | Strategy16回测 < 2秒 | ⬜ |
| P.3 | 数据刷新 | 切换时间范围后数据更新 < 2秒 | ⬜ |

---

## 测试用例

### TC-001: 访问详情页查看策略16数据

**前置条件**: 数据库中有ETHUSDT的K线数据

**操作步骤**:
1. 访问 `/ddps-z/detail/ETHUSDT/`
2. 等待页面加载完成

**预期结果**:
- 页面正常加载
- 统计面板显示策略16统计数据
- K线图显示买卖标记
- 持仓列表显示当前持仓（如有）
- 挂单列表显示当前挂单（如有）

**状态**: ⬜

---

### TC-002: 持仓列表排序验证

**前置条件**: 策略16回测结果有多个持仓

**操作步骤**:
1. 访问详情页
2. 查看持仓列表

**预期结果**:
- 持仓按买入时间倒序排列
- 最新买入的持仓显示在第一行

**状态**: ⬜

---

### TC-003: 持仓浮动盈亏颜色验证

**前置条件**: 有盈利和亏损的持仓

**操作步骤**:
1. 访问详情页
2. 查看持仓列表的浮动盈亏列

**预期结果**:
- 盈利持仓显示绿色
- 亏损持仓显示红色

**状态**: ⬜

---

### TC-004: legacy模式切换验证

**前置条件**: 无

**操作步骤**:
1. 访问 `/api/ddps-z/chart/?symbol=ETHUSDT&strategy_mode=legacy`
2. 检查返回的JSON结构

**预期结果**:
- 返回旧的buy_signals和orders字段
- 不返回strategy16字段

**状态**: ⬜

---

### TC-005: 空数据状态验证

**前置条件**: 策略16回测结果无持仓无挂单

**操作步骤**:
1. 访问详情页（使用历史数据范围）
2. 查看持仓和挂单列表

**预期结果**:
- 持仓列表显示"暂无持仓"
- 挂单列表显示"暂无挂单"

**状态**: ⬜

---

## 验收签字

| 角色 | 姓名 | 日期 | 签字 |
|------|------|------|------|
| 开发 | | | |
| 测试 | | | |
| 产品 | | | |

---

## 备注

_验收过程中的补充说明_
