# PRD: 策略14-优化买入策略

## 文档信息
- **版本**: 1.0
- **创建日期**: 2026-01-11
- **迭代编号**: 030
- **状态**: P1完成

## 1. 核心价值

**一句话定义**: 通过更激进的价格分布(4%首档间隔)和3倍金额递增，在深度回调时获取更优成本。

## 2. 需求背景

策略12使用固定1%间隔的倍增挂单，在小幅回调时容易全部成交，但平均成本改善有限。策略14采用更大的价格间隔和更激进的金额分布，期望：
- 首档快速试探性买入
- 后续档位捕获深度回调
- 通过3倍金额递增实现更优平均成本

## 3. 功能规格

### 3.1 价格计算逻辑

| 档位 | 价格公式 | 示例(base=1000) |
|------|----------|-----------------|
| 第1档 | base_price | 1000 |
| 第2档 | base_price × (1 - first_gap) | 960 (first_gap=4%) |
| 第3档 | base_price × (1 - first_gap - interval) | 950 (interval=1%) |
| 第4档 | base_price × (1 - first_gap - 2×interval) | 940 |
| 第5档 | base_price × (1 - first_gap - 3×interval) | 930 |

**可配置参数**:
- `first_gap`: 首档间隔，默认0.04 (4%)
- `interval`: 后续间隔，默认0.01 (1%)

### 3.2 金额计算逻辑

| 档位 | 金额倍数 | 示例(base=100) |
|------|----------|----------------|
| 第1档 | 1× | 100 |
| 第2档 | 3× | 300 |
| 第3档 | 9× | 900 |
| 第4档 | 27× | 2700 |
| 第5档 | 剩余全部可用资金 | 动态计算 |

**可配置参数**:
- `base_amount`: 首单金额，默认100
- `multiplier`: 金额倍数，默认3

### 3.3 止盈止损逻辑

沿用策略12：
- 止盈: 2% (固定)
- 止损: 6% (固定)
- 单笔独立平仓

## 4. 范围边界

### In-Scope
- 优化价格计算逻辑
- 优化金额分配逻辑
- 第5档动态计算剩余可用资金

### Out-of-Scope
- 止盈止损逻辑修改
- 持仓合并逻辑
- 分批止盈

## 5. 验收标准

| AC编号 | 验收标准 | 验证方法 |
|--------|----------|----------|
| AC-001 | 第2档价格比第1档低4% | 单元测试 |
| AC-002 | 第3-5档价格间隔为1% | 单元测试 |
| AC-003 | 金额按3倍递增 | 单元测试 |
| AC-004 | 第5档使用剩余全部可用资金 | 回测验证 |
| AC-005 | 回测输出正确的订单统计 | 回测命令 |

## 6. 技术约束

- 基于DoublingPositionStrategy代码结构
- 复用LimitOrderPriceCalculator（需扩展）
- 复用LimitOrderManager

## 7. 依赖关系

- 依赖策略12的基础架构
- 依赖现有的指标计算模块
