[Unit]
Description=Grid Trading Bot for %i
After=network.target

[Service]
Type=simple
User=YOUR_USERNAME
WorkingDirectory=/path/to/crypto_exchange_news_crawler
Environment="PATH=/path/to/crypto_exchange_news_crawler/venv/bin:/usr/bin:/bin"
Environment="DJANGO_SETTINGS_MODULE=listing_monitor_project.settings"

# 启动GridBot，%i是实例参数（如btc、eth）
ExecStart=/path/to/crypto_exchange_news_crawler/venv/bin/python /path/to/crypto_exchange_news_crawler/manage.py gridbot --symbol %i

# 重启策略
Restart=on-failure
RestartSec=10
StartLimitInterval=300
StartLimitBurst=5

# 日志配置
StandardOutput=append:/path/to/crypto_exchange_news_crawler/logs/gridbot_%i.log
StandardError=append:/path/to/crypto_exchange_news_crawler/logs/gridbot_%i.log

# 资源限制
MemoryMax=1G
CPUQuota=100%

# 安全配置
PrivateTmp=true
ProtectSystem=strict
ReadWritePaths=/path/to/crypto_exchange_news_crawler/logs
ReadWritePaths=/path/to/crypto_exchange_news_crawler/db.sqlite3

# 优雅关闭
TimeoutStopSec=30
KillMode=mixed

[Install]
WantedBy=multi-user.target
